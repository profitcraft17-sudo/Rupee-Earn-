<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Login - Rupee Earn</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #FF5722; --bg: #ffffff; --light-orange: #fff5f2; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
        body { background: var(--bg); display: flex; align-items: center; justify-content: center; height: 100vh; padding: 20px; }
        
        .login-card { width: 100%; max-width: 400px; text-align: center; }
        .logo-area { margin-bottom: 30px; }
        .logo-area i { font-size: 50px; color: var(--primary); margin-bottom: 10px; }
        .logo-area h2 { font-size: 24px; color: #333; font-weight: 800; }
        .logo-area p { color: #888; font-size: 14px; }
        
        .input-group { position: relative; margin-bottom: 20px; text-align: left; }
        .input-group i { position: absolute; left: 15px; top: 15px; color: #bbb; }
        .input-group input { width: 100%; padding: 15px 15px 15px 45px; border-radius: 15px; border: 1.5px solid #eee; background: #f9f9f9; outline: none; transition: 0.3s; font-size: 14px; }
        .input-group input:focus { border-color: var(--primary); background: #fff; }
        
        .login-btn { width: 100%; padding: 15px; border-radius: 15px; border: none; background: linear-gradient(45deg, #FF5722, #FF7043); color: #fff; font-weight: bold; font-size: 16px; cursor: pointer; box-shadow: 0 8px 20px rgba(255, 87, 34, 0.2); margin-top: 10px; }
        .footer-text { margin-top: 25px; font-size: 13px; color: #777; }
        .footer-text a { color: var(--primary); text-decoration: none; font-weight: bold; }

        /* --- SHARED MODAL STYLE (Signup Jaisa Same Size) --- */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .status-card { background: white; width: 100%; max-width: 300px; border-radius: 20px; padding: 25px; text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.2); animation: popIn 0.3s ease-out; }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .status-card h3 { color: #333; font-size: 20px; margin: 10px 0; font-weight: 700; }
        .status-card p { color: #666; font-size: 13px; margin-bottom: 15px; }
        .status-badge { display: block; padding: 10px; border-radius: 12px; font-weight: 700; font-size: 15px; margin-bottom: 20px; }
        .success-style { background: #F1F8E9; color: #388E3C; border: 1px dashed #A5D6A7; }
        .error-style { background: #FFEBEE; color: #C62828; border: 1px dashed #EF9A9A; }
        .go-btn { background: #FF5722; color: white; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; font-size: 15px; }
    </style>
</head>
<body>

    <div class="login-card">
        <div class="logo-area">
            <i class="fa-solid fa-rocket"></i>
            <h2>Welcome Back!</h2>
            <p>Login to continue your earnings in <b>Rupee Earn</b></p>
        </div>
        <form id="loginForm">
            <div class="input-group"><i class="fa fa-phone"></i><input type="number" id="loginPhone" placeholder="Mobile Number" required></div>
            <div class="input-group"><i class="fa fa-lock"></i><input type="password" id="loginPassword" placeholder="Password" required></div>
            <button type="submit" id="loginBtn" class="login-btn">Log In</button>
        </form>
        <div class="footer-text">Don't have an account? <a href="signup.html">Register Now</a></div>
    </div>

    <div class="modal-overlay" id="statusModal">
        <div class="status-card">
            <div id="modalIcon" style="font-size: 45px; margin-bottom: 5px;"></div>
            <h3 id="modalTitle"></h3>
            <p id="modalDesc"></p>
            <div id="modalBadge" class="status-badge"></div>
            <button id="modalBtn" class="go-btn"></button>
        </div>
    </div>

    <script>
        // Updated Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyC5CblS_QukB4MX1e16nLedARao6qSqVHw",
            authDomain: "rupee-earn-dc35d.firebaseapp.com",
            databaseURL: "https://rupee-earn-dc35d-default-rtdb.firebaseio.com",
            projectId: "rupee-earn-dc35d",
            storageBucket: "rupee-earn-dc35d.firebasestorage.app",
            messagingSenderId: "282775294940",
            appId: "1:282775294940:web:89ab4b95626d091a1f7519"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function showPopup(type, title, desc, badgeText, btnText, action) {
            const modal = document.getElementById('statusModal');
            document.getElementById('modalIcon').innerText = type === 'success' ? 'ðŸ”“' : 'âŒ';
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalDesc').innerText = desc;
            const badge = document.getElementById('modalBadge');
            badge.innerText = badgeText;
            badge.className = 'status-badge ' + (type === 'success' ? 'success-style' : 'error-style');
            const btn = document.getElementById('modalBtn');
            btn.innerText = btnText;
            btn.onclick = action;
            modal.style.display = 'flex';
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;
            const btn = document.getElementById('loginBtn');

            // Indian Number Validation
            const indianPattern = /^[6-9]\d{9}$/;
            if (!indianPattern.test(phone)) {
                showPopup('error', 'Invalid Format!', 'Please enter a valid 10-digit Indian number.', 'Verification Failed!', 'Try Again', () => {
                    document.getElementById('statusModal').style.display = 'none';
                });
                return;
            }

            btn.innerText = "Verifying...";
            btn.disabled = true;

            db.ref('users/' + phone).once('value', (snapshot) => {
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    if (userData.password === password) {
                        localStorage.setItem('userPhone', phone);
                        showPopup('success', 'Login Successful!', 'Welcome back to Rupee Earn.', 'Session Started! âœ…', 'Go to Home', () => {
                            window.location.replace('index.html');
                        });
                    } else {
                        showPopup('error', 'Wrong Password!', 'The password you entered is incorrect.', 'Access Denied!', 'Try Again', () => {
                            document.getElementById('statusModal').style.display = 'none';
                            btn.innerText = "Log In";
                            btn.disabled = false;
                        });
                    }
                } else {
                    showPopup('error', 'Not Found!', 'Account with this number does not exist.', 'No User Found!', 'Register Now', () => {
                        window.location.href = 'signup.html';
                    });
                }
            });
        });
    </script>
</body>
</html>